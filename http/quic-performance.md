# 2.8.2 海内外 QUIC 实践结论

距离 HTTP/3 正式发布已经过去了一年半之久，那么 QUIC 的表现如何，是否可以应用到正式环境？爱奇艺基础架构团队对 HTTP/1.1、HTTP/2、HTTP/3 等各版本进行基准测试，笔者征得他们的同意，将测试数据在此分享，以供读者参考。

如图 2-30 所示，根据用户网络状态分级对各协议的耗时表现。测试数据表明，在同等网络环境条件下 HTTP/3 或 H3-29 延迟降低了 1 倍左右。

:::center
  ![](../assets/quic-1.png)<br/>
 图 2-30 不同网络质量下的协议耗时表现（耗时单位 ms）
:::

不过这次测试也发现了另外一个问题，根据图 2-31 的网络请求成功率的测试结果看，HTTP/3 或 H3-29 比 HTTP/2 的失败率更高。


:::center
  ![](../assets/quic-3.png)<br/>
 图 2-31 不同网络质量下的协议成功率表现
:::

笔者 2024 年初在海外各地区也进行一番测试，采样的数据表明“HTTP/3 的失败率比 HTTP/2 要高一倍左右”，错误类型绝大多数为 Lost connection。

综合来看无论是在服务端还是客户端，QUIC 协议的集成并非一件易事：

- 服务端要考虑网络模型需要适配 QUIC 协议栈做调整，同时还要考虑和 TCP 的兼容，且 TCP 在内核已经经过足够的优化去适配各种环境问题，由此也产生疑问“QUIC 流量的能耗比，是否做到和 TCP 一样的能耗性能？”。
- 客户端要考虑应用适配成本和收益之间的权衡，普通的应用是否有必要升级成 QUIC，这需要业务需求和技术投入的综合考量。如果要升级 QUIC，可能还需要新旧网络库都存在，以便进行降级容错，这使得逻辑代码更为复杂。