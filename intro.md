# 前言

如果你是一位互联网从业者，我猜出这几年你大概率被这些层出不穷的概念包围：云计算、PaaS、FaaS、CaaS、ServiceMesh、Serverless、可观测性、OLAP，当然不能遗漏了各种 Ops，诸如 DevOps、GitOps、MLOps、FinOps 等等。

近几年来，软件开发技术发生了翻天覆地的变化，这也直接对构建上层应用产生了重大的影响。分析那些让人兴奋的技术，以及讨论如何为业务赋能之前，我们先思考引发这一波技术浪潮的核心驱动力是什么？

## 软件在吞噬世界

互联网投资人 Mark Andreessen 曾发表过一篇文章《软件在吞噬世界》，文章内容主要阐述了软件如何影响各个行业。援引原文部分内容：

:::tip 《软件在吞噬世界》节选

我们处于戏剧性和广泛的技术和经济转变的中间，软件公司准备接管大量的经济。
...
十年前，当我在创办的 Netscape 公司时，大概只有 500 万人使用宽带互联网，而现在有超过 20 亿人使用宽带互联网.,
...
:::

文章发表于 2011 年，2023 年再来回顾互联网的冲击，感触更加深刻，部分软件变成像水、电、媒一样的基础设施。

作者展望互联网规模时，写道“在接下来的 10 年里，我预计全球至少有 50 亿人拥有智能手机，每个人每天都可以随时随地使用手机充分利用互联网”。现在，我们已经可以确认 Mark Andreessen 的预测很正确，移动互联网时代的用户规模已经开始向人口基数看齐，开始出现各类亿级 DAU 规模的移动应用。

软件对各行各业的渗透和对世界的改变，以及移动互联网时代巨大的用户基数下快速变更和不断创新的需求对软件开发方式带来巨大的推动力，我们清晰地看到如此波澜壮阔的技术浪潮：

- 软件正在改变世界。
- 移动互联网让这个变革影响到每一个人。
- 传统软件开发方式受到巨大的挑战。
- 因为云计算以及相关技术的普及，软件上云成为趋势。
- 云计算的形态持续在演进。

过去二十年，软件的规模和质量要求不断提升，云基础设施和平台日益强大，软件技术逐渐发展成为它本来该有的模样，形成了与云环境匹配的架构，并催生了相应的开发流程和方法论。

## 大时代下的个体

视角转回到个体，不管你是否接受，软件行业解决问题的技术一直在变化。

并且这种变化并不是平缓的升级，而是剧烈的革新替代。例如，容器取代虚拟机，服务网格取代 Spring Cloud，观测替代监控，Network Policy 替代 iptables 等等，这种革新替代导致软件开发中许多习以为常的假设全被打破。剧烈变化的背景下，如果我们只专注于手头的工作，不抬头看天，大革命来临的时候，之前关注的细节可能再也没有意义。

所以，本书很少描述某个软件如何安装、如何使用，而更关注问题的本质。本书将深入探讨不同解决方案的设计选择，剖析核心原理，并尝试揭示技术发展的规律。例如，网络优化受限于物理世界的约束，分布式系统的演进则是对 CAP 定理的权衡，受时间和空间法则的制约。近几年流行的容器、服务网格也不是什么黑科技，只是把计算机的基本原理、方法重新组合，换种形式解决业务变化带来的新问题。

读完本书，相信你将对系统的整体运作有全新的理解，能够更加得心应手地进行方案取舍，从容应对各种复杂问题。

## 本书适合哪些读者

本书主要面向软件工程师、架构师和技术负责人，特别适合那些需要在系统架构中做出权衡的技术决策者。即便你不直接参与这些决策，本书也能帮助你深入理解各种技术的优缺点。

阅读本书时，最好了解一些请求/响应型（Web）系统原理，熟悉一些常见的网络协议（譬如 TCP、HTTP 等）。如果再有一些后端开发经验，这将加深对本书内容的理解，至于你熟悉何种编程语言倒没有太大关系。

总体上讲，若以下条件适用你，你将从本书获取收益。

- 想了解行业技术发展趋势和动态。
- 需要在系统架构中做出权衡，避免常见设计陷阱。
- 需要构建高可用、健壮的系统。
- 对互联网系统的整体运作有着天然的兴趣，并乐于探索其中的奥秘。

## 如何阅读本书

本书总共分为 4 大部分：

1. 第一部分，是全书的绪论，内容只有第 1 章。我们将从需求的背景、解决问题的角度讨论这几年技术架构演进的趋向。该部分适合所有读者，尤其是希望了解近期技术发展概况的人士。

2. 第二部分，主题是网络。实现高可用服务的前提是，确保用户请求顺利到达服务端。我们将从一道经典的面试题“浏览器打开 url 到页面展现，中间发生了什么？”出发，了解贯穿其中的整个网络请求链路，并努力实现“足够快”目标（第 2 章）。紧接着，跟着网络数据包进入内核网络，学习操作系统制定的根本规则、了解内核中各个模块/设备如何有机协作（第 3 章），最后根据网络数据包的转发/处理，讨论四层及七层负载均衡的设计模式和工作原理（第 4 章）。

3. 第三部分，内容关于分布式系统，我们先认识什么是数据一致性，然后讨论 CAP 定理以及受它影响而来的各个分布式事务模型（第 5 章）。接下来，我们向分布式副本容错模型进军，这是实现分布式系统可靠性的关键，其中的难点在于网络不可靠、节点可能宕机的环境下，如何实现共识（第 6 章）。
3. 第四部分，主题是基础设施的变革，我们先了解 Google 内部系统是怎么演变的，学习 Kubernetes 中关于计算、网络、存储逻辑中设计（第 7 章）。然后，回顾这十几年间服务通信的演化历史，搞清楚服务网格技术是如何出现的、解决了什么问题（第 8 章）。接下来的课题是根据系统运行状态的蛛丝马迹，保障复杂分布式系统的可靠运行（第 9 章）。最后第 10 章是提高生产力的秘籍，将介绍一种以声明式系统为基座、以 Git 为单一可信源的交付模型。

## 致谢

首先感谢我的爱人，在我决定下笔之际义无反顾地担负起照顾两个孩子的责任，并在两年时间内忍受我将工作之余的时间全部用在写作上，没有她的支持我无法完成该著作。

本书部分内容来源于我过往实践的总结，其次也参考了大量他人的思想、论文和著作，这些内容我已在本书脚注、内容备注和结论参考等不同形式呈现，如果您对这部分内容感兴趣，可以继续扩展阅读。

最后，谨以此书，献给我的家人以及热爱技术的朋友们。

## 勘误

限于作者的认知和精力，本书难免产生各种各样的错误。如果您在阅读时发现问题，欢迎评判指正，我将继续在本书的网址 [https://www.thebyte.com.cn/](https://www.thebyte.com.cn/) 进行勘误修正。

