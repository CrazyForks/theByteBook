# 第四章：负载均衡技术

:::tip <a/>
当你试图解释一条命令、一个语言特性或是一种硬件的时候，请首先说明它要解决的问题。

:::right 
—— 摘自《编程珠玑》[^1]
:::

如今，互联网应用、大数据处理系统再或者机器学习系统，一般都采用集群部署的方式对外提供服务。

通过集群方式对外提供服务时，无论是利用多台机器扩展服务能力，还是通过副本提高可用性和容错性，都希望用户的请求能够在**任何连接的机器上得到一致的处理**。同时，**集群还必须对用户保持足够的透明度**。也就是说，客户端与集群交互时，就如同与一台高性能、高可用的服务器进行交互一样。部分服务器的加入或退出不会中断服务，用户无法察觉这些变化，且客户端无需进行任何修改。

为集群提供统一入口并承担相关职责的组件称为负载均衡。根据软硬件层面的不同，负载均衡可分为两种类型：一是利用专用网络设备（如 F5、Cisco、A10 等）实现的硬件负载均衡；二是基于通用服务器的应用程序（如 Nginx、HAProxy、Traefik 等）实现的软件负载均衡。根据请求在网络层的处理层面来看，负载均衡又分为四层负载均衡和七层负载均衡。

无论负载均衡以何种形式存在，或在集群中的何处部署，核心职责无外乎“选择处理用户请求的目标”，即负载均衡算法，和“将用户请求转发至目标”，即负载均衡的工作模式。本章我们围绕这两个核心职责，分析四层和七层负载均衡的设计原理与工作模式，深入理解各类负载均衡应用技术。

:::center
  ![](../assets/balance-summary.png)<br/>
  图 4-0 本章内容导读
:::

[^1]:《编程珠玑》作者是 Jon Bentley，被誉为影响算法发展的十位大师之一。在卡内基-梅隆大学担任教授期间，他培养了包括 Tcl 语言设计者 John Ousterhout、Java 语言设计者 James Gosling、《算法导论》作者之一Charles Leiserson 在内的许多计算机科学大家。