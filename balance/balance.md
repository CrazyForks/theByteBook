# 4.1 负载均衡概述

图 4-1 展示了负载均衡的高层架构，多个客户端（Client）通过负载均衡器（Load Balancer）访问后端服务器（RealServer）。
:::center
  ![](../assets/balancer.svg)<br/>
 图 4-1 负载均衡高层架构图
:::

从整体架构来看，中间的负载均衡器承担以下关键职责：

- **服务发现**：识别系统中可用的后端服务器，并获取它们的地址，以便负载均衡器与后端通信。
- **健康检查**：确定哪些后端服务器处于健康状态并能够接收请求。
- **负载均衡**：基于适当的算法将请求均匀分配到健康的后端服务器上。

合理使用负载均衡能为分布式系统带来诸多优势：

- **命名抽象**：客户端通过预设机制（如 DNS 或内置库）访问负载均衡器，而无需了解后端服务器的拓扑结构或配置。
- **容错**：通过健康检查和多种负载均衡算法，将请求均匀转发至正常的后端服务器，故障服务器则会被移出负载均衡池，便于运维人员从容修复。
- **成本和性能收益**：分布式系统通常是异构的，后端服务器分布在多个网络区域（Zone/Region）。负载均衡器通过策略优先将请求保持在同一网络区域内，从而提高服务性能（减少延迟）并降低资源成本（减少跨区域带宽费用）。



若从网络层处理请求的层面看，所有的负载均衡可总结为两类：**四层负载均衡和七层负载均衡**。在介绍它们的原理、工作模式之前，我们先根据表 4-2，建立一个初步的印象。

:::center
表 4-1 四层负载均衡与七层负载均衡的区别
::: 

|特性|四层负载均衡（L4）|七层负载均衡（L7）|
|:--|:--|:--|
|工作层次|传输层（TCP/UDP）|应用层（HTTP/HTTPS）|
|处理速度	|较快（在内核层面处理，低延迟）	|相对较慢（增加了应用层的处理开销）|
|灵活性|较低，基于 IP 和端口进行路由|高，基于内容、请求头等进行路由|
|功能|主要实现流量分发|支持内容缓存、内容路由、SSL 终止（SSL Termination）等高级功能|
|适用场景|实时应用、简单的 TCP/UDP 服务|Web 应用、微服务架构、复杂请求处理|


