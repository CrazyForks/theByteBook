# 5.6 小结

本章，我们首先了解事务的 ACID 特性，然后通过 CAP 定理探讨一致性、可用性和分区容错性之间的权衡关系。接着，介绍了在 CAP 定理约束下寻求平衡的弱一致性事务模型，如 BASE、TCC 和 SAGA。同时，补充了实施这些模型时必须考虑的“幂等性”原则，这是确保分布式事务在失败和重试情况下保持数据一致性的关键。

最后，你是否体会到，分布式事务的思想，其实就是从悲观锁的强一致性事务，变成分阶段的锁的柔性事务。使用 TCC、SAGA 等机制，把事务控制从数据库资源层挪到业务服务层，弱化资源的锁定从而提升系统可用性。


无论是 TCC、SAGA，如果某个节点在事务执行期间挂掉了，那恢复就会成为问题。解决的办法就是引入多个“备份”。在一个服务宕机之后，某个“备份”顶上。如果服务本身是无状态的，还相对比较容易。如果服务是有状态的，则情况就变得非常棘手。因为必须保证所有的“备份”必须精确和原来的服务一模一样。



参考文档：
- CAP定理的图解证明 https://mwhittaker.github.io/blog/an_illustrated_proof_of_the_cap_theorem/
- 分布式系统八大缪误 https://nighthacks.com/jag/res/Fallacies.html
- 《凤凰架构》周志明