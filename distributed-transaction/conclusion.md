# 5.5 小结


本章，我们首先了解事务的 ACID 特性，然后通过 CAP 定理探讨一致性、可用性和分区容错性之间的权衡关系。接着，介绍了在 CAP 定理约束下寻求平衡的弱一致性事务模型，如 BASE、TCC 和 SAGA。同时，补充了实施这些模型时必须考虑的“幂等性”原则，这是确保分布式事务在失败和重试情况下保持数据一致性的关键。

此刻，你是否体会到“分布式事务的思想”，就是从悲观锁的强一致性事务，变成分阶段的锁的柔性事务。使用 TCC、SAGA 等机制，把事务控制从数据库资源层挪到业务服务层，弱化资源的锁定从而提升系统可用性。


最终一致性保证不一致是暂时的，最终会达到一致。但这是一个非常脆弱的保证，它无法告诉我们系统什么时候达到一致。系统达到一致之前，读请求可能会返回任何值或者失败，对于业务工程师而言，最终一致性会带来很大的处理挑战。


接下来的内容，笔者将介绍一种强一致性模型，也称线性一致性（Linearizability）：

- 系统中所有操作的执行必须看起来是按一个全局的时序顺序执行，并且每个操作看起来是原子发生的；
- 顺序符合实际时间上的因果关系：操作完成的时间早于另一操作开始的时间，则它们在全局顺序中也应按相同的顺序排列。


如何实现线性一致性笔者将在下一章展开讨论。


参考文档：
- CAP定理的图解证明 https://mwhittaker.github.io/blog/an_illustrated_proof_of_the_cap_theorem/
- 分布式系统八大缪误 https://nighthacks.com/jag/res/Fallacies.html
- 《凤凰架构》周志明